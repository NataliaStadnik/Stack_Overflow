{"version":3,"file":"MySnippetsPage-D2E3YiEm.js","sources":["../../src/api/snippets/fetchUserSnippets.ts","../../src/Pages/MySnippetsPage/MySnippetsPage.tsx"],"sourcesContent":["import { instance } from \"../../api/config\";\nimport { AllSnippets, DataSnippet } from \"../typesSnippetComment\";\nimport { PageNumber } from \"../users/allUsersFetch\";\nimport { fetchComments } from \"./fetchComments\";\n\n\nexport async function fetchUserSnippets(id:string, page: PageNumber): Promise<AllSnippets> {\n  const data = (await instance.get(`/snippets?userId=${id}&page=${page}`)).data\n  const clone: AllSnippets = JSON.parse(JSON.stringify(data.data))\n\n  await Promise.all(\n    clone.data.map(async(elem:DataSnippet) => {\n      const data = await fetchComments(elem.id);\n      elem['comments'] = data.comments;\n    })\n  )\n  return clone;\n}\n","import { useQuery } from \"@tanstack/react-query\";\nimport HeaderSection from \"../../Widgets/HeaderSection/HeaderSection\";\nimport Pagination from \"../../Widgets/Pagination/Pagination\";\nimport \"./mySnippetsPage.css\";\nimport Loader from \"../../Shared/Loader/Loader\";\nimport SnippetsList from \"../../Widgets/SnippetsList/SnippetsList\";\nimport { useSelector } from \"react-redux\";\nimport { RootState } from \"../../store/store\";\nimport { fetchUserSnippets } from \"../../api/snippets/fetchUserSnippets\";\nimport { useNavigate, useSearchParams } from \"react-router\";\nimport { Button } from \"ui-components_innowise\";\nimport { useState } from \"react\";\nimport DotsLoader from \"../../Shared/DotsLoader/DotsLoader\";\nimport usePages from \"../../hooks/usePages\";\n\nconst MySnippetsPage = () => {\n  const [params] = useSearchParams();\n  const [page, setPage] = useState(params.get(\"page\") || \"1\");\n\n  const myId = useSelector((state: RootState) => state.userState.id);\n  const navigate = useNavigate();\n\n  const { error, isError, isSuccess, data, isPending, refetch, isFetching } =\n    useQuery({\n      queryFn: () => fetchUserSnippets(myId, page),\n      queryKey: [`snippets/${myId}`],\n      retry: 1,\n    });\n\n  usePages({ page, setPage, refetch });\n\n  if (isPending) {\n    return <Loader type=\"big\" />;\n  }\n\n  const handleClick = (e: React.MouseEvent) => {\n    e.preventDefault();\n    navigate(\"/snippet/new\");\n  };\n\n  return (\n    <>\n      <HeaderSection title=\"My Snippets\" />\n      <Pagination\n        currentPage={page}\n        setPage={setPage}\n        maxPage={data?.meta.totalPages}\n      />\n\n      {isFetching && <DotsLoader />}\n\n      {isError && (\n        <div>\n          <span className=\"error\">Error: {error.message}</span>\n        </div>\n      )}\n\n      {isSuccess &&\n        (data.data.length ? (\n          <SnippetsList\n            classes={isFetching ? \"snippet-list__load\" : \"\"}\n            dataObj={data.data}\n          />\n        ) : (\n          <div className=\"empty\">\n            <p className=\"title no-snippets\">You don't have any snippets!</p>\n            <Button\n              href={\"/snippet/new\"}\n              classes=\"no-snippets-btn\"\n              size=\"large\"\n              variant=\"text\"\n              onClick={handleClick}\n            >\n              Create snippet\n            </Button>\n          </div>\n        ))}\n    </>\n  );\n};\n\nexport default MySnippetsPage;\n"],"names":["fetchUserSnippets","id","page","data","instance","clone","elem","fetchComments","MySnippetsPage","params","useSearchParams","setPage","useState","myId","useSelector","state","navigate","useNavigate","error","isError","isSuccess","isPending","refetch","isFetching","useQuery","usePages","jsx","Loader","handleClick","e","jsxs","Fragment","HeaderSection","Pagination","DotsLoader","SnippetsList","Button"],"mappings":"qYAMsB,eAAAA,EAAkBC,EAAWC,EAAwC,CACnF,MAAAC,GAAQ,MAAMC,EAAS,IAAI,oBAAoBH,CAAE,SAASC,CAAI,EAAE,GAAG,KACnEG,EAAqB,KAAK,MAAM,KAAK,UAAUF,EAAK,IAAI,CAAC,EAE/D,aAAM,QAAQ,IACZE,EAAM,KAAK,IAAI,MAAMC,GAAqB,CACxC,MAAMH,EAAO,MAAMI,EAAcD,EAAK,EAAE,EACnCA,EAAA,SAAcH,EAAK,QACzB,CAAA,CACH,EACOE,CACT,CCFA,MAAMG,EAAiB,IAAM,CACrB,KAAA,CAACC,CAAM,EAAIC,EAAgB,EAC3B,CAACR,EAAMS,CAAO,EAAIC,EAAAA,SAASH,EAAO,IAAI,MAAM,GAAK,GAAG,EAEpDI,EAAOC,EAAaC,GAAqBA,EAAM,UAAU,EAAE,EAC3DC,EAAWC,EAAY,EAEvB,CAAE,MAAAC,EAAO,QAAAC,EAAS,UAAAC,EAAW,KAAAjB,EAAM,UAAAkB,EAAW,QAAAC,EAAS,WAAAC,CAAW,EACtEC,EAAS,CACP,QAAS,IAAMxB,EAAkBa,EAAMX,CAAI,EAC3C,SAAU,CAAC,YAAYW,CAAI,EAAE,EAC7B,MAAO,CAAA,CACR,EAIH,GAFAY,EAAS,CAAE,KAAAvB,EAAM,QAAAS,EAAS,QAAAW,CAAA,CAAS,EAE/BD,EACK,OAAAK,EAAA,IAACC,EAAO,CAAA,KAAK,KAAM,CAAA,EAGtB,MAAAC,EAAeC,GAAwB,CAC3CA,EAAE,eAAe,EACjBb,EAAS,cAAc,CACzB,EAEA,OAEIc,EAAA,KAAAC,WAAA,CAAA,SAAA,CAACL,EAAAA,IAAAM,EAAA,CAAc,MAAM,aAAc,CAAA,EACnCN,EAAA,IAACO,EAAA,CACC,YAAa/B,EACb,QAAAS,EACA,QAASR,GAAA,YAAAA,EAAM,KAAK,UAAA,CACtB,EAECoB,SAAeW,EAAW,EAAA,EAE1Bf,GACEO,EAAAA,IAAA,MAAA,CACC,SAACI,OAAA,OAAA,CAAK,UAAU,QAAQ,SAAA,CAAA,UAAQZ,EAAM,OAAA,CAAA,CAAQ,CAChD,CAAA,EAGDE,IACEjB,EAAK,KAAK,OACTuB,EAAA,IAACS,EAAA,CACC,QAASZ,EAAa,qBAAuB,GAC7C,QAASpB,EAAK,IAAA,CAGhB,EAAA2B,EAAA,KAAC,MAAI,CAAA,UAAU,QACb,SAAA,CAACJ,EAAA,IAAA,IAAA,CAAE,UAAU,oBAAoB,SAA4B,+BAAA,EAC7DA,EAAA,IAACU,EAAA,OAAA,CACC,KAAM,eACN,QAAQ,kBACR,KAAK,QACL,QAAQ,OACR,QAASR,EACV,SAAA,gBAAA,CAAA,CAED,EACF,EAAA,EAEN,CAEJ"}