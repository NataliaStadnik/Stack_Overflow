import{i as o,r as c,u as S,q as E,c as N,j as e,L as u,d as l}from"./index-BM7gXiEi.js";import{E as _}from"./ErrorMessageFetch-2ytYcsZd.js";import{u as v}from"./useLastIdLocation-2wvBTfus.js";import{C as L}from"./CodeEditor-DXR2qW-n.js";function b(s){const t=[];return s.map(a=>{t.push({value:a,label:a})}),t}async function q(s,t){await o.patch(`/snippets/${t}`,s).catch(a=>{throw new Error(a.response.data.message)})}async function C(s){await o.post("/snippets",s).catch(t=>{throw new Error(t.response.data.message)})}async function F(){return(await o.get("/snippets/languages").catch(s=>{throw new Error(s.response.data.message)})).data.data}const Q=({values:s="",selects:t="",update:a=!1,snippetID:d=""})=>{const g=v(),[n,m]=c.useState(s),[i,p]=c.useState(t),r=S({mutationFn:()=>a?q({code:i,language:n},d):C({code:i,language:n}),onSuccess(){p(""),E.invalidateQueries({queryKey:[`snippets/${g}}`]})}}),{error:h,isError:w,isSuccess:x,data:y,isPending:f}=N({queryFn:()=>F(),queryKey:["snippets/languages"],retry:1});return f?e.jsx(u,{type:"big"}):e.jsxs("form",{className:"snippet-form",onSubmit:j=>{j.preventDefault(),r.mutate()},children:[w&&e.jsx("div",{children:e.jsxs("span",{className:"error",children:["Error: ",h.message]})}),e.jsxs("div",{className:"new-snippet",children:[e.jsx("h3",{className:"new-snippet__title",children:"Language of your snippet:"}),x&&e.jsx(l.Select,{selectedItem:n,onChange:m,classes:"new-wrap",label:"Select language",required:!0,options:b(y)})]}),e.jsxs("div",{className:"new-snippet new-snippet__body",children:[e.jsx("h3",{className:"new-snippet__title code-title",children:"Code of your snippet:"}),e.jsx(L,{value:i,setValue:p,classes:"new-snippet__code",language:n,readonly:!1}),r.isSuccess&&e.jsxs("span",{className:"register--correct",children:["Snippet ",a?"updated":"created",' successfully!"']}),e.jsx(_,{mutation:r})]}),e.jsx(l.Button,{classes:"new-snippet__btn",children:r.isPending?e.jsx(u,{type:"small"}):a?"Update snippet":"Create snippet"})]})};export{Q as N};
//# sourceMappingURL=NewSnippet-NkjXcmec.js.map
