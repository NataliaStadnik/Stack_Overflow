{"version":3,"file":"HomePage-oNkCtA7M.js","sources":["../../src/api/snippets/fetchSnippets.ts","../../src/api/snippets/fetchSnippetsComments.ts","../../src/Pages/HomePage/HomePage.tsx"],"sourcesContent":["import { instance } from \"../config\"\nimport { AllSnippets } from \"../typesSnippetComment\"\nimport { PageNumber } from \"../users/allUsersFetch\"\n\nexport async function fetchSnippets(page:PageNumber = '1'): Promise<AllSnippets> {\n  return (await instance.get(`/snippets?page=${page}`)\n    .catch((err) => {\n        throw new Error(err.response.data.message)\n      })).data.data\n}\n","import { userType } from \"../auth/authLogin\";\nimport { AllSnippets, DataSnippet } from \"../typesSnippetComment\";\nimport { PageNumber } from \"../users/allUsersFetch\";\nimport { fetchComments } from \"./fetchComments\";\nimport { fetchSnippets } from \"./fetchSnippets\";\n\nexport type CommentsArray = Array<OneComment>\n\nexport type OneComment = {\n  id: string,\n  content: string,\n  user: userType\n}\n\n\nexport async function fetchSnippetsComments(page:PageNumber = '1'):Promise<AllSnippets>{\n  const data = await fetchSnippets(page);\n  const clone: AllSnippets = JSON.parse(JSON.stringify(data))\n\n  await Promise.all(\n    clone.data.map(async(elem:DataSnippet) => {\n      const data = await fetchComments(elem.id);\n      elem['comments'] = data.comments;\n    })\n  )\n  return clone;\n}\n","import \"./homePage.css\";\nimport Favicon from \"../../svg/Favicon\";\nimport HeaderSection from \"../../Widgets/HeaderSection/HeaderSection\";\nimport Pagination from \"../../Widgets/Pagination/Pagination\";\nimport SnippetsList from \"../../Widgets/SnippetsList/SnippetsList\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport Loader from \"../../Shared/Loader/Loader\";\nimport { useState } from \"react\";\nimport DotsLoader from \"../../Shared/DotsLoader/DotsLoader\";\nimport { fetchSnippetsComments } from \"../../api/snippets/fetchSnippetsComments\";\nimport usePages from \"../../hooks/usePages\";\nimport { useSearchParams } from \"react-router\";\n\nconst HomePage = () => {\n  const [params] = useSearchParams();\n  const [page, setPage] = useState(params.get(\"page\") || \"1\");\n\n  const { error, isError, isSuccess, data, isPending, refetch, isFetching } =\n    useQuery({\n      queryFn: () => fetchSnippetsComments(page),\n      queryKey: [\"snippets\"],\n      retry: 1,\n    });\n\n  usePages({ page, setPage, refetch });\n\n  if (isPending) {\n    return <Loader type=\"big\" />;\n  }\n\n  return (\n    <div className=\"section__home\">\n      <HeaderSection\n        title=\"Welcom to Codelang!\"\n        children={<Favicon classes=\"title-favicon\" color=\"#000\" />}\n      />\n      <Pagination\n        currentPage={page}\n        setPage={setPage}\n        maxPage={data?.meta.totalPages}\n      />\n\n      {isFetching && <DotsLoader />}\n\n      {isError && (\n        <div>\n          <span className=\"error\">Error: {error.message}</span>\n        </div>\n      )}\n\n      {isSuccess && (\n        <SnippetsList\n          classes={isFetching ? \"snippet-list__load\" : \"\"}\n          dataObj={data.data}\n        />\n      )}\n    </div>\n  );\n};\n\nexport default HomePage;\n"],"names":["fetchSnippets","page","instance","err","fetchSnippetsComments","data","clone","elem","fetchComments","HomePage","params","useSearchParams","setPage","useState","error","isError","isSuccess","isPending","refetch","isFetching","useQuery","usePages","jsx","Loader","jsxs","HeaderSection","Favicon","Pagination","DotsLoader","SnippetsList"],"mappings":"6WAIsB,eAAAA,EAAcC,EAAkB,IAA2B,CACvE,OAAA,MAAMC,EAAS,IAAI,kBAAkBD,CAAI,EAAE,EAChD,MAAOE,GAAQ,CACZ,MAAM,IAAI,MAAMA,EAAI,SAAS,KAAK,OAAO,CAAA,CAC1C,GAAG,KAAK,IACf,CCMsB,eAAAC,EAAsBH,EAAkB,IAAyB,CAC/E,MAAAI,EAAO,MAAML,EAAcC,CAAI,EAC/BK,EAAqB,KAAK,MAAM,KAAK,UAAUD,CAAI,CAAC,EAE1D,aAAM,QAAQ,IACZC,EAAM,KAAK,IAAI,MAAMC,GAAqB,CACxC,MAAMF,EAAO,MAAMG,EAAcD,EAAK,EAAE,EACnCA,EAAA,SAAcF,EAAK,QACzB,CAAA,CACH,EACOC,CACT,CCbA,MAAMG,EAAW,IAAM,CACf,KAAA,CAACC,CAAM,EAAIC,EAAgB,EAC3B,CAACV,EAAMW,CAAO,EAAIC,EAAAA,SAASH,EAAO,IAAI,MAAM,GAAK,GAAG,EAEpD,CAAE,MAAAI,EAAO,QAAAC,EAAS,UAAAC,EAAW,KAAAX,EAAM,UAAAY,EAAW,QAAAC,EAAS,WAAAC,CAAW,EACtEC,EAAS,CACP,QAAS,IAAMhB,EAAsBH,CAAI,EACzC,SAAU,CAAC,UAAU,EACrB,MAAO,CAAA,CACR,EAIH,OAFAoB,EAAS,CAAE,KAAApB,EAAM,QAAAW,EAAS,QAAAM,CAAA,CAAS,EAE/BD,EACKK,EAAA,IAACC,EAAO,CAAA,KAAK,KAAM,CAAA,EAI1BC,EAAA,KAAC,MAAI,CAAA,UAAU,gBACb,SAAA,CAAAF,EAAA,IAACG,EAAA,CACC,MAAM,sBACN,SAAWH,EAAA,IAAAI,EAAA,CAAQ,QAAQ,gBAAgB,MAAM,MAAO,CAAA,CAAA,CAC1D,EACAJ,EAAA,IAACK,EAAA,CACC,YAAa1B,EACb,QAAAW,EACA,QAASP,GAAA,YAAAA,EAAM,KAAK,UAAA,CACtB,EAECc,SAAeS,EAAW,EAAA,EAE1Bb,GACEO,EAAAA,IAAA,MAAA,CACC,SAACE,OAAA,OAAA,CAAK,UAAU,QAAQ,SAAA,CAAA,UAAQV,EAAM,OAAA,CAAA,CAAQ,CAChD,CAAA,EAGDE,GACCM,EAAA,IAACO,EAAA,CACC,QAASV,EAAa,qBAAuB,GAC7C,QAASd,EAAK,IAAA,CAAA,CAChB,EAEJ,CAEJ"}