import{j as s,i as l,u,d as p,L as h,a as x,s as P,q as y,b}from"./index-BM7gXiEi.js";import{H as S}from"./HeaderSection-COAfhMFu.js";import{A as v}from"./AccountInfo-3iJM92_F.js";import{u as g,I as w,t as j}from"./zod-CberE-wn.js";import{K as d,f as N,l as E}from"./loginElementArr-Bu_bBODg.js";import{E as f}from"./ErrorMessageFetch-2ytYcsZd.js";import{z as n}from"./index-ans_9-if.js";import"./IconButton-D6lSfURL.js";import"./UserInfo-BaL3RFY8.js";const C=[{id:1,svg:s.jsx(d,{}),placeholder:"Old password",type:"password",name:"oldPassword"},{id:2,svg:s.jsx(d,{}),placeholder:"New password",type:"password",name:"newPassword"},{id:3,svg:s.jsx(d,{}),placeholder:"Confirm password",type:"password",name:"confirm"}],M=n.object({oldPassword:n.string().min(6,"Password should be at least 6 characters"),newPassword:n.string().min(6,"Password should be at least 6 characters"),confirm:n.string().min(6,"Password should be at least 6 characters")}).refine(a=>a.newPassword===a.confirm,{message:"The passwords don't match",path:["confirm"]});async function A(a){const t=Object.fromEntries(Object.entries(a).filter(([o])=>o!=="confirm"));await l.patch("/me/password",t).catch(o=>{throw new Error(o.response.data.message)})}const U=()=>{const{register:a,handleSubmit:t,formState:{errors:o},reset:i}=g({resolver:j(M)}),c=u({mutationFn:A,onSuccess(){i()}});return s.jsxs("form",{className:"edit-password",onSubmit:t(e=>{c.mutate(e)}),children:[s.jsx("h4",{children:"Change your password:"}),C.map(e=>{var r;return s.jsx(w,{svg:e.svg,placeholder:e.placeholder,type:e.type,inputProp:{...a(e.name)},errorMessage:(r=o[e.name])==null?void 0:r.message},e.id)}),s.jsx(f,{mutation:c}),c.isSuccess&&s.jsx("span",{className:"register--correct",children:'Password successfully updated!"'}),s.jsx(p.Button,{classes:"edit-user--btn",children:c.isPending?s.jsx(h,{type:"small"}):"Change password"})]})},F=n.object({username:n.string().min(5,"Username should be at least 5 characters"),password:n.string().min(6,"Password should be at least 6 characters")});async function I(a){return await l.patch("/me",a),N()}const _=()=>{const a=x(),{register:t,handleSubmit:o,formState:{errors:i},reset:c}=g({resolver:j(F)}),e=u({mutationFn:I,onSuccess(r){a(P(r)),c(),y.invalidateQueries({queryKey:["me"]})}});return s.jsxs("form",{className:"edit-name",onSubmit:o(r=>{e.mutate(r)}),children:[s.jsx("h4",{children:"Change your username:"}),E.map(r=>{var m;return s.jsx(w,{svg:r.svg,placeholder:r.placeholder,type:r.type,inputProp:{...t(r.name)},errorMessage:(m=i[r.name])==null?void 0:m.message},r.id)}),s.jsx(f,{mutation:e}),e.isSuccess&&s.jsx("span",{className:"register--correct",children:'Username successfully updated!"'}),s.jsx(p.Button,{classes:"edit-user--btn",children:e.isPending?s.jsx(h,{type:"small"}):"Save"})]})},q=()=>s.jsxs("div",{className:"edit-profile",children:[s.jsx("h3",{className:"edit-profile__title",children:"Edit your profile:"}),s.jsxs("div",{className:"edit-wrapper",children:[s.jsx(_,{}),s.jsx(U,{})]})]}),T=()=>{const a=b(t=>t.userState.username);return s.jsxs("section",{className:"account",children:[s.jsx(S,{children:s.jsxs("div",{className:"account__title",children:[s.jsx("span",{children:"Welcome,"}),s.jsx("span",{className:"welcome",children:a})]})}),s.jsx(v,{forPage:"account"}),s.jsx(q,{})]})};export{T as default};
//# sourceMappingURL=AccountPage-Cy4plrzU.js.map
