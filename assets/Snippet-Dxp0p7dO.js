import{r as p,j as s,b as g,f as j,U as A,d as D,i as I,l as z,m as R,n as V,g as Z,u as $}from"./index-BM7gXiEi.js";import{I as m}from"./IconButton-D6lSfURL.js";import{M as B}from"./Message-CnKAuWI7.js";import{f as E}from"./fetchComments-BR2g0jFQ.js";const F=({value:e})=>{const t=p.useMemo(()=>e==null?void 0:e.split(`
`).map((i,n)=>({id:n,numString:n+1,code:i})),[e]);return s.jsx("ul",{className:"snippet__body codebase",children:t==null?void 0:t.map(({id:i,numString:n,code:a})=>s.jsxs("li",{className:"codebase__item",children:[s.jsx("code",{className:"codebase__text",children:n}),s.jsx("div",{className:"snippet-text code-text",children:s.jsx("code",{children:s.jsx("pre",{children:a})},i)})]},i))})},U=({classes:e})=>s.jsx("svg",{className:e,"aria-hidden":"true",width:"800px",height:"800px",viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg",children:s.jsxs("g",{children:[s.jsx("g",{children:s.jsx("rect",{width:"48",height:"48",fill:"none"})}),s.jsxs("g",{children:[s.jsx("path",{d:"M22,35h-.5a2,2,0,0,1-1.4-2.5l4-17.9a2,2,0,1,1,3.8,1l-4,18A1.9,1.9,0,0,1,22,35Z"}),s.jsx("path",{d:"M17,31a2,2,0,0,0,1.3-3.5L14,24l4.3-3.5a2,2,0,1,0-2.6-3l-6,5a2,2,0,0,0,0,3l6,5A1.9,1.9,0,0,0,17,31Z"}),s.jsx("path",{d:"M31,31a2,2,0,0,1-1.3-3.5L34,24l-4.3-3.5a2,2,0,0,1,2.6-3l6,5a2,2,0,0,1,0,3l-6,5A1.9,1.9,0,0,1,31,31Z"}),s.jsx("path",{d:"M44,6H4A2,2,0,0,0,2,8V40a2,2,0,0,0,2,2H44a2,2,0,0,0,2-2V8A2,2,0,0,0,44,6ZM42,38H6V10H42Z"})]})]})}),b=({dataObj:e})=>{const t=g(a=>a.userState.id),i=j(),n=a=>{a.preventDefault(),i(`/snippet/edit/${e.id}`)};return s.jsxs("div",{className:"snippet__header",children:[s.jsxs("div",{className:"snippet__user",children:[s.jsx(A,{classes:"snippet__svg",color:"#4e4e4e"}),s.jsx("span",{className:"snippet-text",children:e.user.username})]}),t===e.user.id&&s.jsx(D.Button,{href:`/edit_snippet/${e.id}`,classes:"comment__update",size:"small",variant:"text",onClick:n,children:"Edit snippet"}),s.jsxs("div",{className:"snippet__language",children:[s.jsx(U,{classes:"snippet__svg"}),s.jsx("span",{className:"snippet-text",children:e.language})]})]})},G=({classes:e})=>s.jsx("svg",{className:e,"aria-hidden":"true",width:"800px",height:"800px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:s.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8.1 20.5c0 1.5 1.482 2.5 2.64 2.5.806 0 .869-.613.993-1.82.055-.53.121-1.174.267-1.93.386-2.002 1.72-4.56 2.996-5.325V8C15 5.75 14.25 5 11 5H7.227C5.051 5 4.524 6.432 4.328 6.964A15.85 15.85 0 0 1 4.315 7c-.114.306-.358.546-.638.82-.31.306-.664.653-.927 1.18-.311.623-.27 1.177-.233 1.67.023.299.044.575-.017.83-.064.27-.146.475-.225.671-.143.356-.275.686-.275 1.329 0 1.5.748 2.498 2.315 2.498H8.5S8.1 19 8.1 20.5zM18.5 15a1.5 1.5 0 0 0 1.5-1.5v-7a1.5 1.5 0 0 0-3 0v7a1.5 1.5 0 0 0 1.5 1.5z",fill:"#c54343"})}),q=({classes:e})=>s.jsx("svg",{className:e,"aria-hidden":"true",width:"800px",height:"800px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:s.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M15.9 4.5C15.9 3 14.418 2 13.26 2c-.806 0-.869.612-.993 1.82-.055.53-.121 1.174-.267 1.93-.386 2.002-1.72 4.56-2.996 5.325V17C9 19.25 9.75 20 13 20h3.773c2.176 0 2.703-1.433 2.899-1.964l.013-.036c.114-.306.358-.547.638-.82.31-.306.664-.653.927-1.18.311-.623.27-1.177.233-1.67-.023-.299-.044-.575.017-.83.064-.27.146-.475.225-.671.143-.356.275-.686.275-1.329 0-1.5-.748-2.498-2.315-2.498H15.5S15.9 6 15.9 4.5zM5.5 10A1.5 1.5 0 0 0 4 11.5v7a1.5 1.5 0 0 0 3 0v-7A1.5 1.5 0 0 0 5.5 10z",fill:"#28ca28"})});function k(e,t){let i=0,n=0,a="none";e.length!==0&&e.map(c=>{c.type==="like"&&(i+=1,o(c.user.id,"like")),c.type==="dislike"&&(n+=1,o(c.user.id,"dislike"))});function o(c,r){c===t&&(a=r)}return{like:i.toString(),dislike:n.toString(),status:a}}async function J(e,t){const i={mark:e};return await I.post(`/snippets/${t}/mark`,i),E(t)}const K=({to:e="posts",dataObj:t})=>{var h;const i=g(l=>l.userState.id),n=z(),a=R(),o=j(),{href:c}=V(`${e}/${t.id}`),r=k(t.marks,i),[_,f]=p.useState(r.like),[v,w]=p.useState(r.dislike),[S,M]=p.useState(r.status),N=l=>{n.pathname.includes("/posts")&&l.preventDefault()};function d(l){return $({mutationFn:()=>J(l,t.id),onSuccess(y){const u=k(y.marks,i);w(u.dislike),f(u.like),M(u.status)}})}const C=d("like"),L=d("dislike"),H=d("none"),x=l=>{if(!a){o("/login");return}if(l===S){H.mutate();return}if(l==="like"){C.mutate();return}if(l==="dislike"){L.mutate();return}};return s.jsxs("div",{className:"snippet__footer",children:[s.jsxs("div",{className:"snippet__likes",children:[s.jsx(m,{onClick:()=>x("like"),label:_,classes:"likes-wrap snippet-text",svg:s.jsx(q,{classes:"snippet__svg"})}),s.jsx(m,{onClick:()=>x("dislike"),label:v,classes:"likes-wrap snippet-text",svg:s.jsx(G,{classes:"snippet__svg"})})]}),s.jsxs(Z,{onClick:N,to:c,className:"snippet__feedback",children:[s.jsx("span",{className:"snippet-text comments__count",children:(h=t.comments)==null?void 0:h.length}),s.jsx(B,{classes:"snippet__svg"})]})]})},T=({children:e,dataObj:t})=>s.jsxs(s.Fragment,{children:[s.jsxs("article",{className:"snippet__wrapper",children:[s.jsx(b,{dataObj:t}),s.jsx(F,{value:t.code}),s.jsx(K,{dataObj:t})]}),e]});export{T as S};
//# sourceMappingURL=Snippet-Dxp0p7dO.js.map
