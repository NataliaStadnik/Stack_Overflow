{"version":3,"file":"AllUsersPage-dqdu1_ER.js","sources":["../../src/Widgets/OneUser/OneUser.tsx","../../src/api/users/allUsersFetch.ts","../../src/Pages/AllUsersPage/AllUsersPage.tsx"],"sourcesContent":["import { FC } from \"react\";\nimport UserInfo from \"../../Shared/UserInfo/UserInfo\";\nimport \"./oneUser.css\";\nimport { Button } from \"ui-components_innowise\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { fetchStatistic } from \"../../api/users/fetchStatistic\";\nimport { userType } from \"../../api/auth/authLogin\";\nimport Loader from \"../../Shared/Loader/Loader\";\nimport { getStatisticArr } from \"../AccountInfo/accountInfoArr\";\nimport InfoElement from \"../../Shared/InfoElement/InfoElement\";\nimport User from \"../../svg/User\";\n\ninterface OneUserProps {\n  dataObj: userType;\n}\n\nconst OneUser: FC<OneUserProps> = ({ dataObj }) => {\n  const { error, data, refetch, isFetching, isSuccess, isError } = useQuery({\n    queryFn: () => fetchStatistic(dataObj.id),\n    queryKey: [`${dataObj.id}/statistic`],\n    enabled: false,\n  });\n\n  const handleClick = () => {\n    refetch();\n  };\n\n  return (\n    <div className={`one-user ${isSuccess ? \"one-user-statistic\" : \"\"}`}>\n      <User color=\"grey\" classes=\"one-user__img\" />\n      <UserInfo data={dataObj} />\n\n      {!isSuccess && (\n        <Button onClick={handleClick}>\n          {isFetching ? <Loader type=\"small\" /> : \"Show statistic\"}\n        </Button>\n      )}\n      {isError && (\n        <div className=\"error-message\">\n          <span className=\"error\">Error: {error.message}</span>\n        </div>\n      )}\n      {isSuccess && (\n        <ul className=\"infos-list\">\n          {getStatisticArr(data)?.map((elem) => (\n            <InfoElement key={elem.id} label={elem.label} value={elem.value} />\n          ))}\n        </ul>\n      )}\n    </div>\n  );\n};\n\nexport default OneUser;\n","import { instance } from \"../config\"\nimport { userType } from \"../auth/authLogin\"\n\nexport type Links = {\n  current: string,\n  last: string,\n  next: string\n}\n\nexport type Meta = {\n  currentPage: string,\n  itemsPerPage: string,\n  sortBy: Array<[string]>,\n  totalItems: string,\n  totalPages: string\n}\n\ntype allUsersType = {\n  data: Array<userType>,\n  links: Links,\n  meta: Meta\n}\n\nexport type PageNumber = Partial<string>\n\nexport async function allUsersFetch(page:PageNumber = '1'): Promise<allUsersType> {\n  return (await instance.get(`/users?page=${page}`)\n    .catch((err) => {\n        throw new Error(err.response.data.message)\n      })).data.data\n}\n","import HeaderSection from \"../../Widgets/HeaderSection/HeaderSection\";\nimport \"./allUsersPage.css\";\nimport Pagination from \"../../Widgets/Pagination/Pagination\";\nimport OneUser from \"../../Widgets/OneUser/OneUser\";\nimport { allUsersFetch } from \"../../api/users/allUsersFetch\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport Loader from \"../../Shared/Loader/Loader\";\nimport { useState } from \"react\";\nimport DotsLoader from \"../../Shared/DotsLoader/DotsLoader\";\nimport usePages from \"../../hooks/usePages\";\nimport { useSearchParams } from \"react-router\";\n\nconst AllUsersPage = () => {\n  const [params] = useSearchParams();\n  const [page, setPage] = useState(params.get(\"page\") || \"1\");\n\n  const { error, isError, isSuccess, isPending, data, refetch, isFetching } =\n    useQuery({\n      queryFn: () => allUsersFetch(page),\n      queryKey: [\"users\"],\n      retry: 1,\n    });\n\n  usePages({ page, setPage, refetch });\n\n  if (isPending) {\n    return <Loader type=\"big\" />;\n  }\n\n  return (\n    <section className=\"all-users\">\n      <HeaderSection title={\"All Users\"} />\n\n      <Pagination\n        currentPage={page}\n        setPage={setPage}\n        maxPage={data?.meta.totalPages}\n      />\n\n      {isFetching && <DotsLoader />}\n\n      {isError && (\n        <div>\n          <span className=\"error\">Error: {error.message}</span>\n        </div>\n      )}\n      {isSuccess && (\n        <ul\n          className={`all-users-list ${isFetching ? \"snippet-list__load\" : \"\"}`}\n        >\n          {data.data.map((elem) => (\n            <OneUser key={elem.id} dataObj={elem} />\n          ))}\n        </ul>\n      )}\n    </section>\n  );\n};\n\nexport default AllUsersPage;\n"],"names":["OneUser","dataObj","error","data","refetch","isFetching","isSuccess","isError","useQuery","fetchStatistic","handleClick","jsx","User","UserInfo","Button","Loader","jsxs","_a","getStatisticArr","elem","InfoElement","allUsersFetch","page","instance","err","AllUsersPage","params","useSearchParams","setPage","useState","isPending","usePages","HeaderSection","Pagination","DotsLoader"],"mappings":"0TAgBA,MAAMA,EAA4B,CAAC,CAAE,QAAAC,KAAc,OAC3C,KAAA,CAAE,MAAAC,EAAO,KAAAC,EAAM,QAAAC,EAAS,WAAAC,EAAY,UAAAC,EAAW,QAAAC,GAAYC,EAAS,CACxE,QAAS,IAAMC,EAAeR,EAAQ,EAAE,EACxC,SAAU,CAAC,GAAGA,EAAQ,EAAE,YAAY,EACpC,QAAS,EAAA,CACV,EAEKS,EAAc,IAAM,CAChBN,EAAA,CACV,EAEA,cACG,MAAI,CAAA,UAAW,YAAYE,EAAY,qBAAuB,EAAE,GAC/D,SAAA,CAAAK,EAAA,IAACC,EAAK,CAAA,MAAM,OAAO,QAAQ,gBAAgB,EAC3CD,EAAAA,IAACE,EAAS,CAAA,KAAMZ,CAAS,CAAA,EAExB,CAACK,GACCK,EAAAA,IAAAG,EAAAA,OAAA,CAAO,QAASJ,EACd,SAAaL,EAAAM,EAAA,IAACI,EAAO,CAAA,KAAK,OAAQ,CAAA,EAAK,iBAC1C,EAEDR,SACE,MAAI,CAAA,UAAU,gBACb,SAACS,EAAAA,KAAA,OAAA,CAAK,UAAU,QAAQ,SAAA,CAAA,UAAQd,EAAM,OAAA,CAAA,CAAQ,CAChD,CAAA,EAEDI,SACE,KAAG,CAAA,UAAU,aACX,UAAgBW,EAAAC,EAAAf,CAAI,IAAJ,YAAAc,EAAO,IAAKE,SAC1BC,EAA0B,CAAA,MAAOD,EAAK,MAAO,MAAOA,EAAK,KAAxC,EAAAA,EAAK,EAA0C,EAErE,CAAA,CAAA,EAEJ,CAEJ,EC1BsB,eAAAE,EAAcC,EAAkB,IAA4B,CACxE,OAAA,MAAMC,EAAS,IAAI,eAAeD,CAAI,EAAE,EAC7C,MAAOE,GAAQ,CACZ,MAAM,IAAI,MAAMA,EAAI,SAAS,KAAK,OAAO,CAAA,CAC1C,GAAG,KAAK,IACf,CClBA,MAAMC,EAAe,IAAM,CACnB,KAAA,CAACC,CAAM,EAAIC,EAAgB,EAC3B,CAACL,EAAMM,CAAO,EAAIC,EAAAA,SAASH,EAAO,IAAI,MAAM,GAAK,GAAG,EAEpD,CAAE,MAAAxB,EAAO,QAAAK,EAAS,UAAAD,EAAW,UAAAwB,EAAW,KAAA3B,EAAM,QAAAC,EAAS,WAAAC,CAAW,EACtEG,EAAS,CACP,QAAS,IAAMa,EAAcC,CAAI,EACjC,SAAU,CAAC,OAAO,EAClB,MAAO,CAAA,CACR,EAIH,OAFAS,EAAS,CAAE,KAAAT,EAAM,QAAAM,EAAS,QAAAxB,CAAA,CAAS,EAE/B0B,EACKnB,EAAA,IAACI,EAAO,CAAA,KAAK,KAAM,CAAA,EAI1BC,EAAA,KAAC,UAAQ,CAAA,UAAU,YACjB,SAAA,CAACL,EAAAA,IAAAqB,EAAA,CAAc,MAAO,WAAa,CAAA,EAEnCrB,EAAA,IAACsB,EAAA,CACC,YAAaX,EACb,QAAAM,EACA,QAASzB,GAAA,YAAAA,EAAM,KAAK,UAAA,CACtB,EAECE,SAAe6B,EAAW,EAAA,EAE1B3B,GACEI,EAAAA,IAAA,MAAA,CACC,SAACK,OAAA,OAAA,CAAK,UAAU,QAAQ,SAAA,CAAA,UAAQd,EAAM,OAAA,CAAA,CAAQ,CAChD,CAAA,EAEDI,GACCK,EAAA,IAAC,KAAA,CACC,UAAW,kBAAkBN,EAAa,qBAAuB,EAAE,GAElE,SAAAF,EAAK,KAAK,IAAKgB,GACbR,EAAAA,IAAAX,EAAA,CAAsB,QAASmB,GAAlBA,EAAK,EAAmB,CACvC,CAAA,CAAA,CACH,EAEJ,CAEJ"}